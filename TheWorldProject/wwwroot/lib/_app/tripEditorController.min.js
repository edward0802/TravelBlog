(function(){"use strict";function t(t,i){var r=this,u;r.tripName=t.tripName;r.stops=[];r.errorMessage="";r.isBusy=!0;r.newStop={};u="/api/trips/"+r.tripName+"/stops";i.get(u).then(function(t){angular.copy(t.data,r.stops);n(r.stops)},function(){r.errorMessage="Failed to load stops"}).finally(function(){r.isBusy=!1});r.addStop=function(){r.isBusy=!0;r.errorMessage="";i.post(u,r.newStop).then(function(t){r.stops.push(t.data);n(r.stops);r.newStop={}},function(){r.errorMessage="Can't add new Stop..."}).finally(function(){r.isBusy=!1})}}function n(n){if(n&&n.length>0){var t=_.map(n,function(n){return{lat:n.latitude,long:n.longitude,info:n.name}});travelMap.createMap({stops:t,selector:"#map",currentStop:t.length-1,initialZoom:3})}}angular.module("app-trips").controller("tripEditorController",t)})();